SQL 1789 Primary department for each employee


# Write your MySQL query statement below

with res as(
select employee_id, department_id,Count(department_id)
from Employee
group by employee_id
having Count(department_id) = 1)

select employee_id, department_id from res
Union


select employee_id, department_id from (select employee_id, department_id,primary_flag,
 case when    primary_flag = 'Y' then department_id else Null end as p
    from Employee) as s where p is not NULL

